Day02回顧
1、資料類型
  1、數數值型別
  2、字元類型
  3、枚舉類型
    1、單選 ：enum(值1,...)
    2、多選 ：set(值1,值2,...)
      ## "MySQL,Python,Study"
  4、日期時間類型
    1、date
    2、time
    3、datetime # 不給值默認返回NULL
    4、timestamp # 不給值預設返回系統當前時間
2、日期時間函數
  1、NOW()
  2、CURDATE()
  3、CURTIME()
  4、YEAR(欄位名) 
  5、DATE(欄位名)
  6、TIME(欄位名)
  7、日期時間運算
    select ... from 表名
    where 欄位名 運算子(時間-interval 時間間隔單位)
      1 day | 2 day | 3 hour 
3、表字段操作
  1、添加(add)
    alter table 表名 add 欄位名 資料類型 first|after.;
  2、修改(modify)
    alter table 表名 modify 欄位名 新資料類型;
  3、刪除(drop)
    alter table 表名 drop 欄位名;
  4、表重命名(rename)
    alter table 表名 rename 新表名;
  5、表字段重命名(change)
    alter table 表名 change 原名 新名 資料類型;
4、表記錄管理
  1、刪除
    delete from 表名 where 條件;
  2、修改
    update 表名 set 欄位1=值2,... where 條件;
5、運算子
  1、數值&&字元&&邏輯比較
    1、數值 ：> >= < <= = !=
    2、字元 ：= !=
    3、邏輯 ：and  or
  2、範圍內比較
    1、between 數值1 and 數值2 
    2、in(值1,...)
    3、not in(值1,...)
  3、空、非空
    1、is NULL
    2、is not NULL
  4、模糊比較(like)
    1、欄位名 like 運算式
    2、_  %
6、SQL查詢
  1、order by
    1、order by 欄位名 ASC/DESC
  2、limit
    1、limit n
    2、limit m,n
    3、分頁
      每頁顯示m條,顯示第n頁內容
        limit (n-1)*m,m
  3、聚合函數
    avg(...) sum(...) max(...) min(...) 
    count(欄位名) ## 空值NULL不會被統計
Day03筆記
1、SQL查詢
  1、執行順序
    3、select ...聚合函數 from 表名
    1、where ...
    2、group by ...
    4、having ...
    5、order by ...
    6、limit ...
  2、group by
    1、作用 ：給查詢結果進行分組
    2、示例
      1、查詢表中一共有幾個國家

      2、計算每個國家的平均攻擊力
        select country,avg(gongji) from sanguo
        group by country;
        
	先分組 -> 再聚合 -> 再去重
        蜀國
	蜀國
	蜀國   --> 120    --> 蜀國
	魏國
	魏國   --> 110    --> 魏國
	吳國   --> 115    --> 吳國
      3、查找所有國家中英雄數量最多的前2名的 國家名稱和英雄數量
       select country,count(id) as number from sanguo
       group by country
       order by number desc
       limit 2;
    3、注意
      1、group by之後的欄位名必須要為select之後的欄位名
      2、如果select之後的欄位名和group by之後的欄位不一致,則必須對該欄位進行聚合處理(聚合函數)
  3、having語句
    1、作用
      對查詢的結果進行進一步篩選
    2、示例
      1、找出平均攻擊力>105的國家的前2名,顯示國家名和平均攻擊力
       select country,avg(gongji) as pjgj from sanguo
       group by country
       having pjgj>105
       order by pjgj DESC
       limit 2;
    3、注意
      1、having語句通常和group by語句聯合使用,過濾由group by語句返回的記錄集
      2、where只能動作表中實際存在欄位,having可操作由聚合函數生成的顯示列
  4、distinct
    1、作用 ：不顯示欄位重複值
    2、示例
      1、表中都有哪些國家
        select distinct country from sanguo;
      2、計算蜀國一共有多少個英雄
        select count(distinct id) from sanguo 
        where country="蜀國";
    3、注意
      1、distinct和from之間所有欄位都相同才會去重
      2、distinct不能對任何欄位做聚合處理

  5、查詢表記錄時做數學運算
    1、運算子
      +  -  *  /  % 
    2、示例
      1、查詢時所有英雄攻擊力翻倍
        select id,name,gongji*2 as gj from sanguo;
   
   ## sudo apt-get install python3-pip
   ## sudo pip3 install pymysql

2、約束
  1、作用 ：保證資料的完整性、一致性、有效性
  2、約束分類
    1、默認約束(default)
      1、插入記錄,不給該欄位賦值,則使用預設值
    2、非空約束(not NULL)
      1、不允許該欄位的值有NULL記錄
      sex enum("M","F","S") defalut "S"

create table t2(
id int not null,
name varchar(15),
sex enum("M","F","S") default "S"
);





3、索引
  1、定義
    對資料庫表的一列或多列的值進行排序的一種結構(Btree方式)
  2、優點
    加快資料檢索速度
  3、缺點
    1、佔用物理存儲空間
    2、當對表中資料更新時,索引需要動態維護,降低資料維護速度
  4、索引示例
    1、開啟執行時間檢測 ：set profiling=1;
    2、執行查詢語句
      select name from t1 where name="lucy99999";
    3、查看執行時間
      show profiles;
    4、在name欄位創建索引
      create index name on t1(name);
    5、再執行查詢語句
      select name from t1 where name="lucy88888";
    6、查看執行時間
      show profiles;
  5、索引
    1、普通索引(index)
      1、使用規則
        1、可設置多個欄位
	2、欄位值無約束
	3、key標誌 ：MUL
      2、創建index
        1、創建表時
	  create table 表名(...
	  index(欄位名),index(欄位名));
        2、已有表
	  create index 索引名 on 表名(欄位名);
	  create index name on t3(name);
      3、查看索引
        1、desc 表名;  --> KEY標誌為：MUL
	2、show index from 表名\G;
      4、刪除索引
        drop index 索引名 on 表名;

2、唯一索引(unique)
      1、使用規則
        1、可設置多個欄位
	2、約束 ：欄位值不允許重複,但可為 NULL
	3、KEY標誌 ：UNI
      2、創建
        1、創建表時創建
	  unique(欄位名),
	  unique(欄位名)
	2、已有表
	  create unique index 索引名 on 表名(欄位名);
        3、查看、刪除 同 普通索引

3、主鍵索引(primary key)
       自增長屬性(auto_increment,配合主鍵一起使用)
      1、使用規則
        1、只能有一個主鍵欄位
	2、約束 ：不允許重複,且不能為NULL
	3、KEY標誌 ：PRI
	4、通常設置記錄號碼欄位id,能唯一鎖定一條記錄
      2、創建
        1、創建表時
	  (id int primary key auto_increment,
	  )auto_increment=10000;##設置自增長起始值
	  已有表添加自增長屬性：
	    alter table 表名 modify id int auto_increment;
	  已有表重新指定起始值：
	    alter table 表名 auto_increment=20000;
	2、已有表
	  alter table 表名 add primary key(id);
      3、刪除
        1、刪除自增長屬性(modify)
          alter table 表名 modify id int;
	2、刪除主鍵索引
	  alter table 表名 drop primary key;        
    4、外鍵索引
    
4、數據導入
  1、作用 ：把檔案系統的內容導入到資料庫中
  2、語法
    load data infile "/var/lib/mysql-files/檔案名"
    into table 表名
    fields terminated by "分隔符號"
    lines terminated by "\n";
  3、將scoretable.csv檔導入到資料庫的表中
    1、在資料庫中創建對應的表
      create table scoretab(
      id int,
      name varchar(15),
      score float(5,2),
      number bigint,
      class char(7)
      );
    2、把檔拷貝到資料庫的預設搜索路徑中
      1、查看預設搜索路徑
        show variables like "secure_file_priv";
        /var/lib/mysql-files/
      2、拷貝檔
       sudo cp ~/scoretable.csv /var/lib/mysql-files/
    3、執行資料導入語句
      load data infile "/var/lib/mysql-files/scoretable.csv"
      into table scoretab
      fields terminated by ","
      lines terminated by "\n";
    4、文件許可權
       rwxrw-rw- 1 tarena tarena  scoretable.csv
                   所有者 所屬組
       rwx : tarena用戶
       rw- : 同組其他用戶
       rw- : 其他組的其他用戶(mysql用戶)
       
       r -> 4
       w -> 2
       x -> 1
       chmod 644 檔案名   rw-r--r--
    5、Excel表格如何轉化為CSV檔
      1、打開Excel文件 -> 另存為 -> CSV(逗號分隔)
    6、更改檔編碼格式
      1、用記事本/編輯器 打開,檔->另存為->選擇編碼
5、數據匯出
  1、作用 
    將資料庫中表的記錄匯出到系統檔裡
  2、語法格式
    select ... from 表名
    into outfile "/var/lib/mysql-files/檔案名"
    fields terminated by "分隔符號"
    lines terminated by "\n";
  3、把MOSHOU庫下的sanguo表英雄的姓名、攻擊值、國家匯出來,sanguo.txt
    select name,gongji,country from MOSHOU.sanguo
    into outfile "/var/lib/mysql-files/sanguo.txt"
    fields terminated by "   "
    lines terminated by "\n";
    $ sudo -i
    $ cd /var/lib/mysql-files/
    $ ls
    $ cat sanguo.txt
  4、將mysql庫下的user表中 user、host兩個欄位的值匯出到 user.txt
    select user,host from mysql.user 
    into outfile "/var/lib/mysql-files/user.txt" 
    fields terminated by "   " 
    lines terminated by "\n";

作業：
  1、把 /etc/passwd 導入到資料庫表userinfo裡面
    tarena  :  x  :  1000  :  1000  :  tarena,,,
    用戶名   密碼   UID號     GID號    用戶描述
    :  /home/tarena:  /bin/bash
      家目錄/主目錄   登錄許可權
  2、在userinfo第一列添加一個 id 欄位,主鍵、自增長、顯示寬度為3,位元數不夠用0填充
 
  3、面試題
有一張文章評論表comment如下
comment_id	article_id	user_id	date
1	10000	10000	2018-01-30 09:00:00
2	10001	10001	... ...
3	10002	10000	... ...
4	10003	10015	... ...
5	10004	10006	... ...
6	10025	10006	... ...
7	10009	10000	... ...
以上是一個應用的comment表格的一部分，請使用SQL語
句找出在本站發表的所有評論數量最多的10位用戶及評論數，
並按評論數從高到低排序

備註：comment_id為評論id
      article_id為被評論文章的id
      user_id 指用戶id





